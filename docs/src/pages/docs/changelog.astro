---
import DocsLayout from '../../layouts/DocsLayout.astro';
import { components } from '../../data/components/index';

const headings = [
  { id: 'v1-5-1', label: 'v1.5.1' },
  { id: 'v1-5-0', label: 'v1.5.0' },
  { id: 'v1-4-0', label: 'v1.4.0' },
  { id: 'v1-3-0', label: 'v1.3.0' },
  { id: 'v1-2-0', label: 'v1.2.0' },
  { id: 'v1-1-0', label: 'v1.1.0' },
  { id: 'v1-0-0', label: 'v1.0.0' },
  { id: 'components', label: 'Components' },
  { id: 'frameworks', label: 'Framework Wrappers' },
  { id: 'tokens', label: 'Design Tokens' },
];

const tiers = ['layout', 'navigation', 'content', 'input', 'feedback'];
const byTier = Object.fromEntries(
  tiers.map(t => [t, components.filter(c => c.tier === t).sort((a, b) => a.name.localeCompare(b.name))])
);
---

<DocsLayout
  title="Changelog"
  description="ARC UI release history and version notes."
  activeSlug="changelog"
  headings={headings}
  breadcrumbs={[{ label: 'Changelog' }]}
>
  <div class="changelog-page">
    <h1 class="page-title">Changelog</h1>
    <p class="page-desc">
      Release history for ARC UI. All packages are versioned together.
    </p>

    <section id="v1-5-1">
      <h2 class="docs-heading">v1.5.1 — Bug Fixes</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <h3 class="tier-heading">Bug Fixes</h3>
      <ul class="docs-list">
        <li><strong>Shadow DOM CSS reset</strong> — Added a universal reset (<code>margin: 0; padding: 0; box-sizing: border-box</code>) to the shared style module injected into every component. Consumer CSS resets (<code>* &lbrace; margin: 0 &rbrace;</code>) cannot cross shadow DOM boundaries, so browser user-agent defaults (e.g. <code>h2 &lbrace; margin: 0.83em 0 &rbrace;</code>) were leaking into component internals.</li>
        <li><strong>Boolean prop reflection</strong> — 11 boolean properties were missing <code>reflect: true</code>, preventing them from syncing back to HTML attributes when set via JavaScript. Affected props: Alert <code>dismissible</code>, Modal <code>closable</code>, Input <code>required</code> / <code>multiline</code>, DataTable <code>sortable</code> / <code>selectable</code>, ScrollToTop <code>smooth</code>, Form <code>novalidate</code> / <code>error-summary</code>, Link <code>external</code>, FileUpload <code>multiple</code>.</li>
      </ul>
    </section>

    <section id="v1-5-0">
      <h2 class="docs-heading">v1.5.0 — Utility Props Sweep</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <p class="docs-text">
        A comprehensive pass adding utility props across the entire component library.
        Most additions are pure CSS — no breaking changes.
      </p>

      <h3 class="tier-heading">New Props — High Impact</h3>
      <ul class="docs-list">
        <li><strong>Button</strong> — <code>loading</code> prop shows a spinner and disables the button for async operations.</li>
        <li><strong>Input</strong> — <code>error</code> prop for inline validation messages with red border styling. <code>size</code> prop (sm/md/lg).</li>
        <li><strong>Card</strong> — <code>padding</code> prop (none/sm/md/lg) and <code>interactive</code> boolean for clickable cards without href.</li>
        <li><strong>Tabs</strong> — <code>align</code> prop (start/center/end) and <code>variant</code> prop (underline/pills).</li>
        <li><strong>Avatar</strong> — <code>status</code> indicator dot (online/offline/busy/away) and <code>shape</code> prop (circle/square/rounded).</li>
        <li><strong>Badge / Tag</strong> — <code>size</code> prop (sm/md/lg) for both components.</li>
        <li><strong>Container</strong> — <code>size</code> prop (sm/md/lg/xl/full) for max-width control. <code>padding</code> prop (none/sm/md/lg).</li>
        <li><strong>Breadcrumb</strong> — <code>separator</code> prop for custom separator characters (/, >, •).</li>
        <li><strong>TopBar</strong> — <code>nav-align</code> prop (left/center/right) to pin navigation within the center slot.</li>
      </ul>

      <h3 class="tier-heading">New Props — Form Controls</h3>
      <ul class="docs-list">
        <li><strong>Checkbox / Toggle / RadioGroup</strong> — <code>size</code> prop (sm/md/lg) for all three.</li>
        <li><strong>Select</strong> — <code>size</code> prop (sm/md/lg) and <code>error</code> prop for validation state.</li>
        <li><strong>Textarea</strong> — <code>size</code> prop (sm/md/lg) and <code>auto-resize</code> boolean that grows the textarea to fit content.</li>
      </ul>

      <h3 class="tier-heading">New Props — Content &amp; Navigation</h3>
      <ul class="docs-list">
        <li><strong>Divider</strong> — <code>label</code> prop for labeled dividers (e.g. "OR" between form sections).</li>
        <li><strong>Stat</strong> — <code>trend</code> prop (up/down/neutral) with arrow indicator and <code>change</code> prop for percentage display.</li>
        <li><strong>Callout</strong> — <code>dismissible</code> boolean adds a close button and fires <code>arc-dismiss</code>.</li>
        <li><strong>Link</strong> — <code>underline</code> prop (hover/always/never) for fine-grained underline control.</li>
        <li><strong>Progress</strong> — <code>show-value</code> boolean displays the current percentage.</li>
        <li><strong>Sidebar</strong> — <code>position</code> prop (left/right) moves the border to the opposite edge.</li>
        <li><strong>Footer</strong> — <code>align</code> prop (left/center) for centered footer layouts.</li>
      </ul>

      <h3 class="tier-heading">New Props — Feedback &amp; Layout</h3>
      <ul class="docs-list">
        <li><strong>Modal</strong> — <code>fullscreen</code> boolean for full-viewport modals on mobile.</li>
        <li><strong>Alert</strong> — <code>compact</code> boolean reduces padding and font sizes for inline use.</li>
        <li><strong>Toast</strong> — <code>show()</code> now accepts <code>actionLabel</code>, <code>action</code> callback, and <code>persistent</code> to prevent auto-dismiss.</li>
        <li><strong>Accordion</strong> — <code>multiple</code> boolean allows multiple panels open simultaneously.</li>
        <li><strong>Skeleton</strong> — <code>count</code> prop renders multiple stacked skeleton items.</li>
        <li><strong>Pagination</strong> — <code>compact</code> boolean shows only prev/next with a "current / total" label.</li>
      </ul>

      <h3 class="tier-heading">Navigation Menu</h3>
      <ul class="docs-list">
        <li><strong>Muted nav style</strong> — Reworked muted nav items: transparent background by default, white text on hover with soft glowing white pill, faint primary glowing pill for active state.</li>
      </ul>

      <h3 class="tier-heading">Docs</h3>
      <ul class="docs-list">
        <li><strong>See Also links</strong> — Every component page now shows a "See Also" section linking to related components and guide pages. Guide pages also cross-link to each other. Helps users discover related components and navigate between docs naturally.</li>
      </ul>
    </section>

    <section id="v1-4-0">
      <h2 class="docs-heading">v1.4.0 — Component Composition &amp; Token Infrastructure</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <h3 class="tier-heading">Refactors</h3>
      <ul class="docs-list">
        <li><strong>Shared style modules</strong> — Extracted reusable style sheets into composable modules that multiple components import:
          <ul class="docs-list" style="margin-top:var(--space-xs)">
            <li><code>button-styles.js</code> — variant styles (secondary, ghost, focus, disabled) shared by Button, IconButton, and Chip</li>
            <li><code>card-styles.js</code> — hover glow and gradient border shared by Card and FeatureCard</li>
            <li><code>status-styles.js</code> — status color CSS custom properties shared by Alert, Callout, and Toast</li>
            <li><code>status-utils.js</code> — status icon resolver shared by Alert, Callout, and Toast</li>
          </ul>
        </li>
        <li><strong>Callout</strong> — Now uses status color tokens for border and background tinting instead of neutral card styling. Icon color matches the variant.</li>
        <li><strong>TopBar</strong> — Added inner content wrapper to separate backdrop/border from flex layout, exposing a <code>content</code> CSS part.</li>
      </ul>

      <h3 class="tier-heading">Infrastructure</h3>
      <ul class="docs-list">
        <li><strong>Token single source of truth</strong> — <code>shared/tokens.js</code> is now the sole source. <code>tokens.css</code> is generated from it. <code>pnpm generate</code> runs token generation then Prism.</li>
        <li><strong>Fixed focus-glow drift</strong> — Shadow DOM fallbacks had different <code>--focus-ring</code> and <code>--focus-glow</code> values than the CSS file. Both now derive from <code>tokens.focus</code>.</li>
        <li><strong>Light theme completeness</strong> — <code>lightTokens</code> now includes gradient, glow-line, and utility overrides that were previously only in hand-maintained CSS.</li>
      </ul>
    </section>

    <section id="v1-3-0">
      <h2 class="docs-heading">v1.3.0 — Visual Refinements</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <h3 class="tier-heading">Enhancements</h3>
      <ul class="docs-list">
        <li><strong>Badge</strong> — Switched to mono font with no uppercase for a quieter, code-like appearance. Added <code>color</code> prop accepting an RGB triplet (same API as Tag).</li>
        <li><strong>Tag</strong> — Increased vertical padding for more visual prominence. Removed <code>min-height</code> constraint so tags are naturally taller than badges when side by side.</li>
        <li><strong>Toggle</strong> — Label now uses the primary body font instead of the accent font, with normal casing.</li>
      </ul>

      <h3 class="tier-heading">Docs</h3>
      <ul class="docs-list">
        <li>Component page header: tier and interactivity labels now use <code>arc-tag</code> with custom <code>color</code> props instead of <code>arc-badge</code>.</li>
      </ul>
    </section>

    <section id="v1-2-0">
      <h2 class="docs-heading">v1.2.0 — Component Enhancements</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <h3 class="tier-heading">Enhancements</h3>
      <ul class="docs-list">
        <li><strong>Input</strong> — Added <code>prefix</code> and <code>suffix</code> slots for placing icons or inline adornments inside the field box. The input/textarea is now wrapped in a flex container that holds the border and focus styles.</li>
        <li><strong>Tag</strong> — Added <code>color</code> prop accepting an RGB triplet (e.g. <code>"77, 126, 247"</code>) for custom category colours. Overrides variant colours for border, text, background, and hover glow.</li>
        <li><strong>Button</strong> — Added <code>prefix</code> and <code>suffix</code> slots for icons alongside the button label. Both <code>&lt;button&gt;</code> and <code>&lt;a&gt;</code> render paths support slots.</li>
      </ul>
    </section>

    <section id="v1-1-0">
      <h2 class="docs-heading">v1.1.0 — New Components &amp; Enhancements</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>

      <h3 class="tier-heading">New Component</h3>
      <ul class="docs-list">
        <li><strong>CTA Banner</strong> (<code>arc-cta-banner</code>) — Full-width call-to-action banner with gradient background, eyebrow text, headline, and actions slot. Replaces inline CSS patterns on landing pages.</li>
      </ul>

      <h3 class="tier-heading">Enhancements</h3>
      <ul class="docs-list">
        <li><strong>Card</strong> — Added <code>footer</code> slot for action buttons, links, or metadata. Hides automatically when empty.</li>
        <li><strong>PageHeader</strong> — Replaced semantic slots (<code>breadcrumb</code>, <code>actions</code>, <code>tabs</code>) with positional slots (<code>above</code>, <code>aside</code>, <code>below</code>). Added <code>border</code> prop to opt-in to the bottom border (now off by default).</li>
        <li><strong>Form</strong> — Added <code>loading</code> prop to prevent double-submit, <code>disabled</code> prop that propagates to all child controls, <code>error-summary</code> with rendered error list, <code>formData</code> in event detail, and <code>arc-reset</code> event.</li>
        <li><strong>NavItem</strong> — Added <code>muted</code> prop for subdued navigation items that render with lighter text and no border. Supported in both desktop and mobile views.</li>
      </ul>

      <h3 class="tier-heading">Docs</h3>
      <ul class="docs-list">
        <li>Homepage CTA section now uses <code>arc-cta-banner</code>, removing ~50 lines of inline CSS.</li>
        <li>Fixed navigation menu preview dropdown overflow and hover bleed.</li>
        <li>Fixed container preview overflow by using simulated layout.</li>
        <li>Dashboard grid preview: labels now use accent font (Tektur), numbers use body font (Host Grotesk).</li>
      </ul>
    </section>

    <section id="v1-0-0">
      <h2 class="docs-heading">v1.0.0 — Initial Release</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>
      <p class="docs-text">
        The first stable release of ARC UI. Includes {components.length} components across 5 tiers,
        framework wrappers for React, Vue, Svelte, Angular, Solid, and Preact, standalone CSS output,
        and a comprehensive design token system with dark and light themes.
      </p>
    </section>

    <section id="components">
      <h2 class="docs-heading">Components</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>
      <p class="docs-text">
        All {components.length} components ship as Lit web components with zero external dependencies
        beyond Lit itself.
      </p>

      {tiers.map(tier => (
        <div class="tier-group">
          <h3 class="tier-heading">{tier.charAt(0).toUpperCase() + tier.slice(1)}</h3>
          <div class="component-chips">
            {byTier[tier].map(c => (
              <a href={`/components/${c.slug}`} class="component-chip">{c.name}</a>
            ))}
          </div>
        </div>
      ))}
    </section>

    <section id="frameworks">
      <h2 class="docs-heading">Framework Wrappers</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>
      <p class="docs-text">
        Generated by <strong>Prism</strong>, our custom code generator that reads the Lit source and
        produces idiomatic bindings for each framework:
      </p>
      <ul class="docs-list">
        <li><code>@arclux/arc-ui-react</code> — React 18+ via <code>@lit/react</code></li>
        <li><code>@arclux/arc-ui-vue</code> — Vue 3.3+</li>
        <li><code>@arclux/arc-ui-svelte</code> — Svelte 5+</li>
        <li><code>@arclux/arc-ui-angular</code> — Angular 17+ standalone components</li>
        <li><code>@arclux/arc-ui-solid</code> — Solid 1.8+</li>
        <li><code>@arclux/arc-ui-preact</code> — Preact 10.19+</li>
        <li><code>@arclux/arc-ui-html</code> — Standalone CSS + HTML examples</li>
      </ul>
    </section>

    <section id="tokens">
      <h2 class="docs-heading">Design Tokens</h2>
      <arc-divider align="left" variant="line-gradient" style="max-width:48px;margin-bottom:var(--space-md)"></arc-divider>
      <p class="docs-text">
        The v1.0 token set includes 90+ CSS custom properties covering color, typography, spacing,
        shadows, gradients, glows, z-index, breakpoints, motion, and focus styles. Both dark and
        light themes are fully defined. See the <a href="/docs/tokens">Tokens</a> page for the full reference.
      </p>
    </section>
  </div>
</DocsLayout>

<style>
  .tier-group {
    margin-bottom: var(--space-lg);
  }

  .tier-heading {
    font-family: var(--font-accent);
    font-size: var(--text-xs);
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: var(--space-sm);
  }

  .component-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  .component-chip {
    font-size: var(--text-xs);
    font-family: var(--font-mono);
    padding: 4px 10px;
    border-radius: var(--radius-full);
    background: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    color: var(--text-secondary);
    text-decoration: none;
    transition: color var(--transition-fast), border-color var(--transition-fast), background var(--transition-fast);
  }

  .component-chip:hover {
    color: var(--text-primary);
    border-color: var(--border-bright);
    background: var(--bg-card);
  }
</style>
